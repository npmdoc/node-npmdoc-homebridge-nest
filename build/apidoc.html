<div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a

        href="https://github.com/kraigm/homebridge-nest#readme"

    >homebridge-nest (v1.1.2)</a>
</h1>
<h4>Nest plugin for homebridge</h4>
<div class="apidocSectionDiv"><a
    href="#apidoc.tableOfContents"
    id="apidoc.tableOfContents"
><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.homebridge-nest">module homebridge-nest</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-nest.homebridge-nest">
            function <span class="apidocSignatureSpan"></span>homebridge-nest
            <span class="apidocSignatureSpan">(homebridge)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-nest.nest_connection">
            function <span class="apidocSignatureSpan">homebridge-nest.</span>nest_connection
            <span class="apidocSignatureSpan">(token, log)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">homebridge-nest.</span>nest_connection.prototype</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.homebridge-nest.nest_connection">module homebridge-nest.nest_connection</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-nest.nest_connection.nest_connection">
            function <span class="apidocSignatureSpan">homebridge-nest.</span>nest_connection
            <span class="apidocSignatureSpan">(token, log)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.homebridge-nest.nest_connection.prototype">module homebridge-nest.nest_connection.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-nest.nest_connection.prototype.auth">
            function <span class="apidocSignatureSpan">homebridge-nest.nest_connection.prototype.</span>auth
            <span class="apidocSignatureSpan">(clientId, clientSecret, code)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-nest.nest_connection.prototype.isOpen">
            function <span class="apidocSignatureSpan">homebridge-nest.nest_connection.prototype.</span>isOpen
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-nest.nest_connection.prototype.open">
            function <span class="apidocSignatureSpan">homebridge-nest.nest_connection.prototype.</span>open
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-nest.nest_connection.prototype.subscribe">
            function <span class="apidocSignatureSpan">homebridge-nest.nest_connection.prototype.</span>subscribe
            <span class="apidocSignatureSpan">(handler)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.homebridge-nest.nest_connection.prototype.update">
            function <span class="apidocSignatureSpan">homebridge-nest.nest_connection.prototype.</span>update
            <span class="apidocSignatureSpan">(path, data)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.homebridge-nest" id="apidoc.module.homebridge-nest">module homebridge-nest</a></h1>


    <h2>
        <a href="#apidoc.element.homebridge-nest.homebridge-nest" id="apidoc.element.homebridge-nest.homebridge-nest">
        function <span class="apidocSignatureSpan"></span>homebridge-nest
        <span class="apidocSignatureSpan">(homebridge)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">homebridge-nest = function (homebridge) {
	Service = homebridge.hap.Service;
	Characteristic = homebridge.hap.Characteristic;
	Accessory = homebridge.hap.Accessory;
	uuid = homebridge.hap.uuid;

	<span class="apidocCodeCommentSpan">/**
	 * Characteristic &#x22;Away&#x22;
	 */
</span>	Away = function () {
		Characteristic.call(this, &#x27;Away&#x27;, &#x27;D6D47D29-4639-4F44-B53C-D84015DAEBDB&#x27;);
		this.setProps({
			format: Characteristic.Formats.BOOL,
			perms: [Characteristic.Perms.READ, Characteristic.Perms.WRITE, Characteristic.Perms.NOTIFY]
		});
		this.value = this.getDefaultValue();
	};
	inherits(Away, Characteristic);
	Away.HOME = 0;
	Away.AWAY = 1;

	var exportedTypes = {
		Accessory: Accessory,
		Service: Service,
		Characteristic: Characteristic,
		uuid: uuid,
		Away: Away
	};

	DeviceAccessory = require(&#x27;./lib/nest-device-accessory.js&#x27;)(exportedTypes);
	ThermostatAccessory = require(&#x27;./lib/nest-thermostat-accessory.js&#x27;)(exportedTypes);
	ProtectAccessory = require(&#x27;./lib/nest-protect-accessory.js&#x27;)(exportedTypes);
	CamAccessory = require(&#x27;./lib/nest-cam-accessory.js&#x27;)(exportedTypes);

	var acc = NestThermostatAccessory.prototype;
	inherits(NestThermostatAccessory, Accessory);
	NestThermostatAccessory.prototype.parent = Accessory.prototype;
	for (var mn in acc) {
		NestThermostatAccessory.prototype[mn] = acc[mn];
	}

	homebridge.registerPlatform(&#x22;homebridge-nest&#x22;, &#x22;Nest&#x22;, NestPlatform);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.homebridge-nest.nest_connection" id="apidoc.element.homebridge-nest.nest_connection">
        function <span class="apidocSignatureSpan">homebridge-nest.</span>nest_connection
        <span class="apidocSignatureSpan">(token, log)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Connection(token, log) {
	this.token = token;
	this.log = function(info) {
		log(logPrefix + info);
	};
	this.debug = function(info) {
		log.debug(logPrefix + info);
	};
	this.error = function(info) {
		log.error(logPrefix + info);
	};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.homebridge-nest.nest_connection" id="apidoc.module.homebridge-nest.nest_connection">module homebridge-nest.nest_connection</a></h1>


    <h2>
        <a href="#apidoc.element.homebridge-nest.nest_connection.nest_connection" id="apidoc.element.homebridge-nest.nest_connection.nest_connection">
        function <span class="apidocSignatureSpan">homebridge-nest.</span>nest_connection
        <span class="apidocSignatureSpan">(token, log)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Connection(token, log) {
	this.token = token;
	this.log = function(info) {
		log(logPrefix + info);
	};
	this.debug = function(info) {
		log.debug(logPrefix + info);
	};
	this.error = function(info) {
		log.error(logPrefix + info);
	};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.homebridge-nest.nest_connection.prototype" id="apidoc.module.homebridge-nest.nest_connection.prototype">module homebridge-nest.nest_connection.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.homebridge-nest.nest_connection.prototype.auth" id="apidoc.element.homebridge-nest.nest_connection.prototype.auth">
        function <span class="apidocSignatureSpan">homebridge-nest.nest_connection.prototype.</span>auth
        <span class="apidocSignatureSpan">(clientId, clientSecret, code)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">auth = function (clientId, clientSecret, code) {
	return rp({
		method: &#x27;POST&#x27;,
		uri: &#x27;https://api.home.nest.com/oauth2/access_token&#x27;,
		form: {
			client_id: clientId,
			client_secret: clientSecret,
			code: code,
			grant_type: &#x22;authorization_code&#x22;
		}
	})
	.then(function (parsedBody) {
		var body = JSON.parse(parsedBody);
		this.token = body.access_token;
		return this.token;
	}.bind(this));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			return;
		}

		var conn = new NestConnection(token, log);
		if (token) {
			resolve(conn)
		} else {
			conn.<span class="apidocCodeKeywordSpan">auth</span>(clientId, clientSecret, code)
				.then(function(token) {
					if (log) log.warn(&#x22;CODE IS ONLY VALID ONCE! Update config to use {&#x27;token&#x27;:&#x27;&#x22; + token + &#x22;&#x27
;} instead.&#x22;);
					resolve(conn);
				})
				.catch(function(err){
					reject(err);
					if (log) log.warn(&#x22;Auth failed which likely means the code is no longer valid. Should be able to generate a new one at
 &#x22; + authURL);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.homebridge-nest.nest_connection.prototype.isOpen" id="apidoc.element.homebridge-nest.nest_connection.prototype.isOpen">
        function <span class="apidocSignatureSpan">homebridge-nest.nest_connection.prototype.</span>isOpen
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isOpen = function () {
	return this.conn ? true : false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.homebridge-nest.nest_connection.prototype.open" id="apidoc.element.homebridge-nest.nest_connection.prototype.open">
        function <span class="apidocSignatureSpan">homebridge-nest.nest_connection.prototype.</span>open
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">open = function () {
	if (!this.token) {
		return Promise.reject(new Error(&#x22;You must provide a token or auth before you can open a connection.&#x22;));
	}

	this.conn = new Firebase(&#x27;wss://developer-api.nest.com&#x27;, new Firebase.Context());
	return authAsync.call(this)
		.then(function() {
			// Register the callback to be fired every time auth state changes
			this.conn.onAuth(authDataCallback.bind(this));
			return this;
		}.bind(this));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

		var handleUpdates = function(data){
			updateAccessories(data, that.accessoryLookup);
		};
		setupConnection(this.config, this.log)
			.then(function(conn){
				that.conn = conn;
				return that.conn.<span class="apidocCodeKeywordSpan">open</span>();
			})
			.then(function(){
				return that.conn.subscribe(handleUpdates);
			})
			.then(function(data) {
				that.accessoryLookup = generateAccessories(data);
				if (callback) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.homebridge-nest.nest_connection.prototype.subscribe" id="apidoc.element.homebridge-nest.nest_connection.prototype.subscribe">
        function <span class="apidocSignatureSpan">homebridge-nest.nest_connection.prototype.</span>subscribe
        <span class="apidocSignatureSpan">(handler)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">subscribe = function (handler) {
	var self = this;
	return new Promise(function (resolve, reject) {
		if (!handler){
			reject(new Error(&#x22;You must specify a handler&#x22;))
		} else {
			var notify = resolve || handler;
			this.conn.on(&#x27;value&#x27;, function (snapshot) {
				var data = snapshot.val();
				if (data) {
					notify(data);
					notify = handler;
				} else {
					self.log(&#x22;Disconnect Detected&#x22;);
				}
			});
		}
	}.bind(this));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		};
		setupConnection(this.config, this.log)
			.then(function(conn){
				that.conn = conn;
				return that.conn.open();
			})
			.then(function(){
				return that.conn.<span class="apidocCodeKeywordSpan">subscribe</span>(handleUpdates);
			})
			.then(function(data) {
				that.accessoryLookup = generateAccessories(data);
				if (callback) {
					var copy = that.accessoryLookup.map(function (a) { return a; });
					callback(copy);
				}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.homebridge-nest.nest_connection.prototype.update" id="apidoc.element.homebridge-nest.nest_connection.prototype.update">
        function <span class="apidocSignatureSpan">homebridge-nest.nest_connection.prototype.</span>update
        <span class="apidocSignatureSpan">(path, data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">update = function (path, data) {
	var child = this.conn.child(path);
	return Promise.fromCallback(child.set.bind(child, data));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    return &#x27;devices/&#x27; + this.deviceGroup + &#x27;/&#x27; + this.deviceId + &#x27;/&#x27; + property;
};

NestDeviceAccessory.prototype.updateDevicePropertyAsync = function(property, value, propertyDescription, valueDescription) {
    propertyDescription = propertyDescription || property;
    valueDescription = valueDescription || value;
    this.log(&#x22;Setting &#x22; + propertyDescription + &#x22; for &#x22; + this.name + &#x22; to: &#x22; + valueDescription);
    return this.conn.<span class="apidocCodeKeywordSpan">update</span>(this.getDevicePropertyPath(property), value)
        .return(value);
};

NestDeviceAccessory.prototype.getStructurePropertyPath = function(property) {
    return &#x27;structures/&#x27; + this.structureId + &#x27;/&#x27; + property;
};
...</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
